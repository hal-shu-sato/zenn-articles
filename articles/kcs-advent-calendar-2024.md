---
title: "ニコニコ建国記念日だし、今年のニコニコを技術的に見てみる"
emoji: "📺"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["niconico"]
published: false
---

:::message
この記事は、[Computer Society Advent Calendar 2024](https://qiita.com/advent-calendar/2024/kcs)の12/12の記事です。
:::

ご無沙汰しております。ato lashです。

今年のKCSアドカレどうなってるかなーと見たところ、なぜか12/12のアドベントカレンダーが空いていたので、記事を書くことにしました（なお現在は12/20）。

12/12といえば……

もちろん、「ニコニコ建国記念日」ですね！

ということで、今年のニコニコを、一応技術記事なので技術的に見てみたいと思います。

## はじめに

ご存知の方も多いでしょうが、そもそもニコニコ動画とは何なのか軽く説明しておきます。

ニコニコ動画は、2007年12月12日にサービスを開始した国産動画共有サービスです。
特徴としては、動画の再生画面上にコメントが流れる機能があります。
（なんかこれもFC2との訴訟の件がありますね……。今回は触れませんが。）

もともとは、ニワンゴというドワンゴの子会社が運営していましたが、後にドワンゴに吸収合併され、現在はドワンゴが運営しています。
そのドワンゴもKADOKAWAと合併し、今はKADOKAWAの孫会社となっています。

## サイバー攻撃

今年のニコニコは、6月8日のサイバー攻撃により、サービスが一時停止する事態が発生しました。

その頃の私といえば、その一週間前の6月1日（土）は「**_THE IDOLM@STER CINDERELLA GIRLS UNIT LIVE TOUR ConnecTrip! Tokyo Koen_**」で撃沈し、6月7日（金）は「**_Hokkaido Nipponham Fighters_**」の交流戦を見に神宮球場に行き延長戦の末に勝利するなど、まあいわゆる推し活に励んでいました。
4時間半を超える熱戦の末の勝利に、疲れ果てて帰宅し即爆睡。
そして、次の日に起きたらニコニコがダウンしていたという……。

とはいえ、私も技術者の端くれとしてそこら辺の適当なソースのお話では語りたくなかったので、結構静観していたのを覚えています。
（なんかDDoS自称してた人がいましたねえ……）

サイバー攻撃後、公式発表があるまで唯一のツイート
https://x.com/hal_shu_sato/status/1799328663718203430

この情報どこで見つけたのかは覚えていません。
とはいえ、かつて[ニコ生の配信基盤に関するブログ](https://www.wantedly.com/companies/dwango/post_articles/466059)でのオンプレミスに関する記述や[KADOKAWA Connectedに関する記事](https://www.bbtower.co.jp/case/kadokawa_connected2/)は見ていたので、ある程度可能性の高い予想だったからかもしれません。

そして、6/14（金）にやっと公式的に詳細に発表されました。

https://www.youtube.com/watch?v=cEGsGL9vtQk

https://www.youtube.com/watch?v=Kyz47Md9fCw

あーなるほど。
やっぱそっちが攻撃されたのかという感想でした。

## ニコニコの技術

先ほどのブログや[KADOKAWAの2023年3月期 通期決算説明資料](https://ssl4.eir-parts.net/doc/9468/ir_material_for_fiscal_ym10/134967/00.pdf)を読むと、ニコニコのシステムをAWSに移行しようとしていることが分かっており、ニコニコ動画については3月28日に移行が完了しました。
（これについてはニコニコのエンコード仕様を検索したときに発見していました。）

https://blog.nicovideo.jp/niconews/205042.html

https://x.com/dwango_tech/status/1793582739972829485

そして、ニコニコ生放送に関しては2025年1月から移行を開始する予定で、当時はなにも告知がありませんでした。

https://blog.nicovideo.jp/niconews/235926.html

そのため、サイバー攻撃段階ではニコニコ動画の動画配信基盤はAWSに移行済みでしたが、ニコニコ生放送の配信基盤はまだオンプレミスだったということです。

そして、動画などの説明の通り、ニコニコ動画もニコニコ生放送もサービス自体はAWSに移行していたとのことです。

ちなみに、オブジェクトストレージ自体は「RSTOR」を使っていたようです（おそらく動画以外のデータ）。

https://www.itmedia.co.jp/news/articles/2012/10/news091.html

そして、当時の状況では動画や生放送にアクセスはできるけどログインできない、大百科などはアクセスできないような状況であったように記憶しているので、恐らく動画と生放送以外に関してはすべてオンプレミスで動かしていたという予想がついていました。
また、KADOKAWAのコーポレートサイトやKADOKAWA系のアニメ公式サイトがダウンしていたことも発覚していました。

そのため、恐らく状況的にはオンプレミスのKADOKAWAの全体のサーバ群に障害が起きていたのだろうなという感想でした。

ちなみに、DDoSについては「ニコニコはCDNとかWAFがない！」みたいなツイートもありましたが、さすがにAWSに移行した後はCDNくらい使っているだろうの予想で、そんなわけないだろうという気持ちでした（実際そうっぽいし）。

そして、6/14（金）にいきなりリリースされた「ニコニコ動画（Re:仮）」で横転。
自分の知らない（仮）のような雰囲気でとても面白かったです。

このバージョンですが、Wappalyzerで見て「Remix使ってるやん」みたいなツイートもバズってましたね（復旧後の新プレイヤーでも利用されています）。

こちらについては、説明動画も含めて見ていて、AWS側は無事なのでAWS版バックエンドに対応したフロントエンドだけちゃんと用意してバックエンドを微調整すれば、割とすぐに動画を見るくらいはできるだろうと思っていました。

そこから時を経て現在ではニコニコのほぼすべてのサービスが復旧しています。

## まとめ

今年は私の大好きなニコニコ動画が自由に見られない時期がしばらく続き、その期間は非常に苦しいものでした。
しかし、それでもいろいろとサービスが復旧してきて、さらに新機能も追加されてきたことで、どんどん活気が戻ってきてとても嬉しいです。

また、ニコニコ動画だけ知っている人も多いかもしれませんが、ぜひ12/12は「ニコニコ建国記念日」ということもぜひ覚えておいてもらえると泣いて喜びます。
